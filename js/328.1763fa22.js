"use strict";(globalThis["webpackChunkiess_admin_gui"]=globalThis["webpackChunkiess_admin_gui"]||[]).push([[328],{5328:(e,o,l)=>{l.r(o),l.d(o,{default:()=>T});l(3186),l(5531),l(5683),l(9048),l(4702),l(7396),l(923),l(9502);var t=l(1758),i=l(8790),a=l(8734),n=l(2009),u=l(2449),s=l(5107);const r=(0,t.Lk)("div",{class:"text-h4-bold text-neutral-grey_01"},"裁切圖片",-1),c={__name:"cropper-dialog",props:{isShowDialog:{type:Boolean,default:()=>!1,required:!0},uploadImage:{type:String,default:()=>""}},emits:{onClose:()=>!0,onConfirm:e=>!0},setup(e,{emit:o}){const l=e,i=o,n=(0,a.KR)(null),c=(0,a.Kh)({isShowDialog:!1,sizeButtons:[{id:1,label:"16:9",fixedNumber:[16,9]},{id:2,label:"4:3",fixedNumber:[4,3]},{id:3,label:"1:1",fixedNumber:[1,1]},{id:4,label:"2:3",fixedNumber:[2,3]},{id:5,label:"free"}]}),d=(0,a.Kh)({img:null,outputSize:1,outputType:"png",info:!0,canScale:!1,autoCrop:!0,autoCropWidth:640,autoCropHeight:360,fixed:!0,fixedNumber:[16,9],full:!1,fixedBox:!1,canMove:!1,canMoveBox:!0,original:!1,centerBox:!0,height:!0,infoTrue:!0});(0,t.sV)((async()=>{c.isShowDialog=l.isShowDialog,d.img=l.uploadImage})),(0,t.wB)((()=>l.uploadImage),(e=>{d.img=e}));const p=e=>{e=e||1,n.value.changeScale(e)},m=()=>{n.value.rotateLeft()},g=()=>{n.value.rotateRight()},f=(e,o)=>{d.fixed=e,o&&(d.autoCropWidth=640,d.autoCropHeight=d.autoCropWidth/o[0]*o[1],d.fixedNumber=o)},h=e=>{const o=d.fixedNumber.join(":");return(!d.fixed||o!==e)&&!(!d.fixed&&"free"===e)},b=()=>{n.value.getCropData((e=>{i("onConfirm",e),d.img=null}))};return(e,o)=>{const l=(0,t.g2)("q-card-section"),x=(0,t.g2)("q-btn-group"),C=(0,t.g2)("q-card"),v=(0,t.g2)("q-dialog");return(0,t.uX)(),(0,t.Wv)(v,{modelValue:c.isShowDialog,"onUpdate:modelValue":o[6]||(o[6]=e=>c.isShowDialog=e),persistent:""},{default:(0,t.k6)((()=>[(0,t.bF)(C,{class:"custom-dialog-xl q-px-lg q-py-none"},{default:(0,t.k6)((()=>[(0,t.bF)(l,{class:"custom-dialog-title bg-neutral-white q-px-none q-pt-lg q-pb-md",align:"center"},{default:(0,t.k6)((()=>[r,(0,t.bF)(u.A,{class:"custom-dialog-close",flat:"",round:"","prepend-icon":{name:"mdi-close",color:"main-blue"},onClick:o[0]||(o[0]=e=>i("onClose"))})])),_:1}),(0,t.bF)(l,{class:"custom-dialog-main q-px-none q-pt-none scroll",style:{height:"400px"}},{default:(0,t.k6)((()=>[(0,t.bF)((0,a.R1)(s.EJ),{ref_key:"cropper",ref:n,img:d.img,outputSize:d.outputSize,outputType:d.outputType,info:d.info,canScale:d.canScale,autoCrop:d.autoCrop,autoCropWidth:d.autoCropWidth,autoCropHeight:d.autoCropHeight,fixed:d.fixed,fixedNumber:d.fixedNumber,full:d.full,fixedBox:d.fixedBox,canMove:d.canMove,canMoveBox:d.canMoveBox,original:d.original,centerBox:d.centerBox,height:d.height,infoTrue:d.infoTrue},null,8,["img","outputSize","outputType","info","canScale","autoCrop","autoCropWidth","autoCropHeight","fixed","fixedNumber","full","fixedBox","canMove","canMoveBox","original","centerBox","height","infoTrue"])])),_:1}),(0,t.bF)(l,{class:"row justify-between custom-dialog-main q-px-none q-pt-none"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.bF)(x,{push:"",unelevated:""},{default:(0,t.k6)((()=>[(0,t.bF)(u.A,{outline:"","tooltip-txt":"放大","prepend-icon":{name:"mdi-plus",color:"main-blue"},onClick:o[1]||(o[1]=e=>p(1))}),(0,t.bF)(u.A,{outline:"","tooltip-txt":"縮小","prepend-icon":{name:"mdi-minus",color:"main-blue"},onClick:o[2]||(o[2]=e=>p(-1))})])),_:1}),(0,t.bF)(x,{class:"q-ml-sm",push:"",unelevated:""},{default:(0,t.k6)((()=>[(0,t.bF)(u.A,{outline:"","tooltip-txt":"向左旋轉","prepend-icon":{name:"mdi-arrow-u-left-top",color:"main-blue"},onClick:o[3]||(o[3]=e=>m())}),(0,t.bF)(u.A,{outline:"","tooltip-txt":"向右旋轉","prepend-icon":{name:"mdi-arrow-u-right-top",color:"main-blue"},onClick:o[4]||(o[4]=e=>g())})])),_:1}),(0,t.bF)(x,{class:"q-ml-sm",push:"",unelevated:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(c.sizeButtons,(e=>((0,t.uX)(),(0,t.Wv)(u.A,{key:e.id,outline:h(e.label),label:e.label,onClick:o=>f("free"!==e.label,e.fixedNumber)},null,8,["outline","label","onClick"])))),128))])),_:1})]),(0,t.bF)(u.A,{class:"custom-button",label:"確認",onClick:o[5]||(o[5]=e=>b())})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}};var d=l(2156),p=l(3316),m=l(4189),g=l(6031),f=l(8582),h=l.n(f);const b=c,x=b;h()(c,"components",{QDialog:d.A,QCard:p.A,QCardSection:m.A,QBtnGroup:g.A});var C=l(5949);const v={class:"col-12 col-sm-11"},k=(0,t.Lk)("div",{class:"row justify-between items-center q-mb-md"},[(0,t.Lk)("div",{class:"text-h3"},"圖檔管理")],-1),w={class:"row items-center q-gutter-sm"},y={class:"q-mr-sm"},S={key:0,class:"col-12 row items-center justify-center"},q=(0,t.Lk)("div",{class:"col-12 text-h4 text-center text-neutral-grey_02"},"請選擇門市/分行",-1),F=[q],_={key:1,class:"col-12 row items-center justify-center"},I=(0,t.Lk)("div",{class:"col-12 text-h4 text-center text-neutral-grey_02"},"拖曳檔案至此或點擊上傳",-1),A={__name:"index",setup(e){const o=(0,a.Kh)({formValues:{},formList:[{field:"sitesCorp",label:"公司",columnType:"select",options:[]},{field:"sites",label:"門市/分行",columnType:"select",options:[]},{field:"solarEnergy",label:"太陽能",columnType:"select",options:[]}],uploadImageInfo:null,uploadImageUrl:null,croppedFileUrl:null,isShowCropDialog:!1});(0,t.sV)((()=>{o.formList.forEach((e=>{"sitesCorp"===e.field&&(e.options=C.Z9.map((e=>({label:e.corpName,value:e.id}))))}))}));const l=(e,l)=>{"sitesCorp"===e&&o.formList.forEach((e=>("sites"===e.field&&(e.options=C.fS.map((e=>({label:e.sitesName,value:e.id})))),e)))},u=e=>{const l=URL.createObjectURL(e);o.uploadImageUrl=l,o.isShowCropDialog=!0},s=e=>{o.croppedFileUrl=e,o.uploadImageInfo=r(e,o.uploadImageInfo.name),o.isShowCropDialog=!1},r=(e,o)=>{const l=e.split(","),t=l[0].match(/:(.*?);/)[1],i=atob(l[1]);let a=i.length;const n=new Uint8Array(a);while(a--)n[a]=i.charCodeAt(a);return new File([n],o,{type:t})};return(e,a)=>{const r=(0,t.g2)("q-icon"),c=(0,t.g2)("q-img"),d=(0,t.g2)("q-file"),p=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(p,{class:"row justify-center q-py-sm"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",v,[k,(0,t.Lk)("div",w,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(o.formList,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.field,class:"row items-center"},[(0,t.Lk)("div",y,(0,i.v_)(e.label),1),(0,t.bF)(n.A,{modelValue:o.formValues[e.field],"onUpdate:modelValue":l=>o.formValues[e.field]=l,options:e.options,placeholder:"請選擇"+e.label,style:{width:"170px"},onOnUpdateEvent:o=>l(e.field,o)},null,8,["modelValue","onUpdate:modelValue","options","placeholder","onOnUpdateEvent"])])))),128))]),(0,t.Lk)("div",{class:(0,i.C4)(["custom-archive q-mt-md row items-center",{"custom-archive--no-data":!o.croppedFileUrl}])},[o.formValues.sites?o.uploadImageInfo?((0,t.uX)(),(0,t.Wv)(c,{key:2,src:o.croppedFileUrl},null,8,["src"])):((0,t.uX)(),(0,t.CE)("div",_,[(0,t.bF)(r,{class:"col-12",name:"mdi-cloud-upload",size:"100px",color:"neutral-grey_03"}),I])):((0,t.uX)(),(0,t.CE)("div",S,F)),o.formValues.sites?((0,t.uX)(),(0,t.Wv)(d,{key:3,modelValue:o.uploadImageInfo,"onUpdate:modelValue":[a[0]||(a[0]=e=>o.uploadImageInfo=e),u],class:"custom-archive--uploader",accept:"image/*",borderless:""},null,8,["modelValue"])):(0,t.Q3)("",!0)],2)]),o.isShowCropDialog?((0,t.uX)(),(0,t.Wv)(x,{key:0,isShowDialog:o.isShowCropDialog,"upload-image":o.uploadImageUrl,onOnClose:a[1]||(a[1]=e=>{o.isShowCropDialog=!1}),onOnConfirm:s},null,8,["isShowDialog","upload-image"])):(0,t.Q3)("",!0)])),_:1})}}};var B=l(7716),L=l(492),V=l(2665),D=l(9980),U=l(7156);const N=A,T=N;h()(A,"components",{QPage:B.A,QIcon:L.A,QImg:V.A,QFile:D.A,QField:U.A})}}]);