"use strict";(globalThis["webpackChunkiess_admin_gui"]=globalThis["webpackChunkiess_admin_gui"]||[]).push([[345],{8345:(o,e,i)=>{i.r(e),i.d(e,{default:()=>M});var l=i(1758),n=i(8734),t=i(9731),a=i(8790),s=i(739),r=i(9014),m=i(2449),c=i(5949);const u={class:"text-h4-bold text-neutral-grey_01"},f={__name:"setting-dialog",props:{isShowDialog:{type:Boolean,default:()=>!1,required:!0},focusedRow:{type:Object,default:()=>({})},settingInfo:{type:Object,default:()=>({})}},emits:{onClose:()=>!0,onSave:()=>!0},setup(o,{emit:e}){const i=o,s=e,r=(0,n.Kh)({isShowDialog:!1,settingInfo:{},isShowConfirmDialog:!1,confirmDialogInfo:{},columns:[{name:"view",field:"view",label:"顯示功能",align:"center",columnType:"checkbox"},{name:"edit",field:"edit",label:"是否操作",align:"center",columnType:"checkbox"},{name:"mainFeat",field:"mainFeat",label:"平台功能1(上)",align:"left",columnType:"string"},{name:"subMainFeat",field:"subMainFeat",label:"平台功能2(側主)",align:"left",columnType:"string"},{name:"subFeat",field:"subFeat",label:"平台功能3(側次)",align:"left",columnType:"string"}],rows:[]});(0,l.sV)((async()=>{r.isShowDialog=i.isShowDialog,r.settingInfo=i.settingInfo,r.rows=c.kA.map((o=>({...o,isMain:o.mainFeat&&!o.subMainFeat&&!o.subFeat,isSubMain:o.mainFeat&&o.subMainFeat&&!o.subFeat,isShowEditCheckbox:"ISO碳盤查"===o.mainFeat||"智能控制"===o.mainFeat,view:!1,edit:!1}))),f()}));const f=()=>{r.rows.forEach((o=>{r.settingInfo.view&&r.settingInfo.view.includes(o.id)&&(o.view=!0),r.settingInfo.edit&&r.settingInfo.edit.includes(o.id)&&(o.edit=!0)}))},d=o=>{r.rows=o},g=()=>{s("onClose")},p=()=>{r.settingInfo={view:r.rows.filter((o=>o.view)).map((o=>o.id)),edit:r.rows.filter((o=>o.edit)).map((o=>o.id))},r.isShowConfirmDialog=!1,s("onSave",i.focusedRow,r.settingInfo)};return(o,e)=>{const n=(0,l.g2)("q-card-section"),s=(0,l.g2)("q-card-actions"),c=(0,l.g2)("q-card"),f=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.Wv)(f,{class:"custom-dialog-second-layer",modelValue:r.isShowDialog,"onUpdate:modelValue":e[2]||(e[2]=o=>r.isShowDialog=o),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{class:"custom-dialog-lg q-px-lg q-pt-none q-pb-lg"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"custom-dialog-title bg-neutral-white q-px-none q-pt-lg q-pb-md",align:"center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",u,(0,a.v_)(i.focusedRow.identityCode),1)])),_:1}),(0,l.bF)(n,{class:"custom-dialog-main q-px-none q-pt-none"},{default:(0,l.k6)((()=>[(0,l.bF)(t.A,{"table-columns":r.columns,"table-row":r.rows,"table-sets":{tableName:"sitesCorpPermission",cellColor:"#EDEDED",blankColumns:["subMainFeat","subFeat"]},onOnToggleCellCheckbox:d},null,8,["table-columns","table-row"])])),_:1}),(0,l.bF)(s,{class:"custom-button-group custom-dialog-actions bg-neutral-white",align:"center"},{default:(0,l.k6)((()=>[(0,l.bF)(m.A,{class:"custom-button",label:"取消",outline:"",onClick:e[0]||(e[0]=o=>g())}),(0,l.bF)(m.A,{class:"custom-button",label:"確認",onClick:e[1]||(e[1]=o=>p())})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}};var d=i(2156),g=i(3316),p=i(4189),w=i(2669),b=i(8582),h=i.n(b);const S=f,C=S;h()(f,"components",{QDialog:d.A,QCard:g.A,QCardSection:p.A,QCardActions:w.A});var D=i(2521),k=i(2099);const v={class:"text-h4-bold text-neutral-grey_01"},V={key:0,class:"row justify-start items-center q-mb-md"},y={class:"custom-field-name q-pr-md"},F={key:1,class:"row justify-start items-center q-mb-md"},I={__name:"form-dialog",props:{title:{type:String,default:()=>"",required:!0},isShowDialog:{type:Boolean,default:()=>!1,required:!0},size:{type:String,default:()=>"md"},formValues:{type:Object,default:()=>({})}},emits:{onClose:()=>!0,onSave:()=>!0},setup(o,{emit:e}){const i=o,u=e,f=(0,n.KR)(null),d=(0,n.Kh)({isShowDialog:!1,isShowConfirmDialog:!1,confirmDialogInfo:{},isShowSettingDialog:!1,focusedPermissionRow:{},settingInfo:{},stepper:[{id:1,title:"基本設定"},{id:2,title:"權限設定"}],step:1,previousRadioInfo:{},formValues:{},formList:[]});(0,l.sV)((async()=>{d.isShowDialog=i.isShowDialog,d.formList=JSON.parse(JSON.stringify(k.pe)),d.formValues=i.formValues,d.formList=d.formList.map((o=>("permission"===o.field&&(o.options=c.pN.filter((o=>"前台"===o.system))),o)))})),(0,l.wB)((()=>i.formValues),(async o=>{d.formValues=o}));const g=o=>{d.previousRadioInfo[o]===d.formValues[o]&&(d.formValues[o]=null),d.previousRadioInfo[o]=d.formValues[o]},p=(o,e)=>{o&&o.identityCode&&(d.formValues[e]=d.formValues[e]||{},d.settingInfo=d.formValues[e][o.id]||{},d.isShowSettingDialog=!0,d.focusedPermissionRow=o)},w=(o,e)=>{d.formValues.permission[o.id]=e,d.isShowSettingDialog=!1},b=()=>{d.isShowConfirmDialog=!0,d.confirmDialogInfo={title:"確認",content:"所有該身份將更換功能，確定要儲存嗎？",confirmTxt:"確定",cancelTxt:"取消",onCancel:()=>{d.isShowConfirmDialog=!1},onConfirm:()=>{d.isShowConfirmDialog=!1,u("onSave",d.formValues)}}};return(e,i)=>{const n=(0,l.g2)("q-card-section"),c=(0,l.g2)("q-form"),h=(0,l.g2)("q-step"),S=(0,l.g2)("q-stepper-navigation"),k=(0,l.g2)("q-stepper"),I=(0,l.g2)("q-card"),q=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.CE)(l.FK,null,[d.isShowSettingDialog?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(q,{key:0,modelValue:d.isShowDialog,"onUpdate:modelValue":i[4]||(i[4]=o=>d.isShowDialog=o),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(I,{class:(0,a.C4)(["q-px-lg q-py-none",`custom-dialog-${o.size}`])},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"custom-dialog-title bg-neutral-white q-px-none q-pt-lg q-pb-md",align:"center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",v,(0,a.v_)(o.title),1),(0,l.bF)(m.A,{class:"custom-dialog-close",flat:"",round:"","prepend-icon":{name:"mdi-close",color:"main-blue"},onClick:i[0]||(i[0]=o=>u("onClose"))})])),_:1}),(0,l.bF)(k,{modelValue:d.step,"onUpdate:modelValue":i[3]||(i[3]=o=>d.step=o),ref:"stepper",class:"custom-stepper",animated:""},{navigation:(0,l.k6)((()=>[(0,l.bF)(S,{class:"custom-button-group custom-dialog-actions bg-neutral-white"},{default:(0,l.k6)((()=>[(0,l.bF)(m.A,{class:"custom-button",label:"確認",onClick:i[1]||(i[1]=o=>b())}),(0,l.bF)(m.A,{class:"custom-button",label:d.step>1?"上一步":"下一步",outline:"",onClick:i[2]||(i[2]=o=>d.step>1?e.$refs.stepper.previous():e.$refs.stepper.next())},null,8,["label"])])),_:1})])),default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.stepper,(o=>((0,l.uX)(),(0,l.Wv)(h,{key:o.id,name:o.id,title:o.title,prefix:o.id,color:"neutral-grey_03","active-color":"main-blue"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{ref_for:!0,ref_key:"formRef",ref:f,class:"custom-dialog-form"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.formList,(o=>((0,l.uX)(),(0,l.CE)(l.FK,{key:o.field},["permission"!==o.field&&1===d.step?((0,l.uX)(),(0,l.CE)("div",V,[(0,l.Lk)("div",y,[(0,l.Lk)("span",null,(0,a.v_)(o.label),1)]),"text"===o.type?((0,l.uX)(),(0,l.Wv)(s.A,{key:0,modelValue:d.formValues[o.field],"onUpdate:modelValue":e=>d.formValues[o.field]=e,meta:{type:o.type}},null,8,["modelValue","onUpdate:modelValue","meta"])):"radio"===o.type?((0,l.uX)(),(0,l.Wv)(r.A,{key:1,modelValue:d.formValues[o.field],"onUpdate:modelValue":e=>d.formValues[o.field]=e,meta:{options:o.options},onClickRadio:e=>g(o.field)},null,8,["modelValue","onUpdate:modelValue","meta","onClickRadio"])):(0,l.Q3)("",!0)])):"permission"===o.field&&2===d.step?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.bF)(t.A,{class:"full-width","table-columns":o.columns,"table-row":o.options,"table-sets":{actionsType:["setting"]},onOnSetting:e=>p(e,o.field)},null,8,["table-columns","table-row","onOnSetting"])])):(0,l.Q3)("",!0)],64)))),128))])),_:2},1536)])),_:2},1032,["name","title","prefix"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["class"])])),_:1},8,["modelValue"])),d.isShowSettingDialog?((0,l.uX)(),(0,l.Wv)(C,{key:1,"is-show-dialog":d.isShowSettingDialog,"focused-row":d.focusedPermissionRow,"setting-info":d.settingInfo,onOnClose:i[5]||(i[5]=o=>d.isShowSettingDialog=!1),onOnSave:w},null,8,["is-show-dialog","focused-row","setting-info"])):(0,l.Q3)("",!0),d.isShowConfirmDialog?((0,l.uX)(),(0,l.Wv)(D.A,{key:2,"is-show-dialog":d.isShowConfirmDialog,title:d.confirmDialogInfo.title,content:d.confirmDialogInfo.content,"confirm-txt":d.confirmDialogInfo.confirmTxt,"cancel-txt":d.confirmDialogInfo.cancelTxt,onOnCancel:d.confirmDialogInfo.onCancel,onOnConfirm:d.confirmDialogInfo.onConfirm},null,8,["is-show-dialog","title","content","confirm-txt","cancel-txt","onOnCancel","onOnConfirm"])):(0,l.Q3)("",!0)],64)}}};var q=i(7222),x=i(8577),_=i(9200),A=i(4776);const O=I,T=O;h()(I,"components",{QDialog:d.A,QCard:g.A,QCardSection:p.A,QStepper:q.A,QStep:x.A,QForm:_.A,QStepperNavigation:A.A});var Q=i(897);const X={class:"col-12 col-sm-11"},L={class:"row justify-between items-center q-mb-md"},R=(0,l.Lk)("div",{class:"text-h3"},"客戶公司資料",-1),E={class:"row"},W={__name:"sites-corp",setup(o){const e=(0,n.Kh)({isShowFormDialog:!1,formDialogTitle:"",formValues:{},isShowConfirmDialog:!1,confirmDialogInfo:{},searchValue:"",columns:[{name:"actions",align:"center",label:"操作"}],rows:[]});(0,l.sV)((()=>{e.columns=[...e.columns,...Q.m9],e.rows=JSON.parse(JSON.stringify(c.Z9))}));const i=()=>{e.isShowFormDialog=!0,e.formDialogTitle="新增公司"},a=o=>{e.isShowFormDialog=!0,e.formDialogTitle="編輯公司",e.formValues={...o}},s=o=>{e.isShowConfirmDialog=!0,e.confirmDialogInfo={title:"刪除",content:"確定要刪除嗎？",confirmTxt:"確定",cancelTxt:"取消",onConfirm:()=>{e.isShowConfirmDialog=!1},onCancel:()=>{e.isShowConfirmDialog=!1}}},r=()=>{e.isShowFormDialog=!1,e.formValues={}},u=()=>{console.log("searchValue:",e.searchValue)},f=o=>{e.isShowFormDialog=!1,e.rows=e.rows.map((e=>(e.id===o.id&&(e={...o}),e))),e.formValues={}};return(o,n)=>{const c=(0,l.g2)("q-input"),d=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(d,{class:"row justify-center q-py-sm"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",X,[(0,l.Lk)("div",L,[R,(0,l.Lk)("div",E,[(0,l.bF)(c,{modelValue:e.searchValue,"onUpdate:modelValue":n[1]||(n[1]=o=>e.searchValue=o),class:"q-mr-sm",color:"main-blue",placeholder:"搜尋",outlined:"",dense:""},{append:(0,l.k6)((()=>[(0,l.bF)(m.A,{flat:"",round:"",dense:"","prepend-icon":{name:"mdi-magnify",color:"main-blue"},onClick:n[0]||(n[0]=o=>u())})])),_:1},8,["modelValue"]),(0,l.bF)(m.A,{class:"custom-button-round",outline:"",round:"","tooltip-txt":"新增","prepend-icon":{name:"mdi-plus",color:"main-blue"},onClick:n[2]||(n[2]=o=>i())})])]),(0,l.bF)(t.A,{"table-columns":e.columns,"table-row":e.rows,"table-sets":{actionsType:["edit","delete"]},onOnEdit:a,onOnDelete:s},null,8,["table-columns","table-row"])]),e.isShowFormDialog?((0,l.uX)(),(0,l.Wv)(T,{key:0,"is-show-dialog":e.isShowFormDialog,title:e.formDialogTitle,size:"lg","form-values":e.formValues,onOnClose:r,onOnSave:f},null,8,["is-show-dialog","title","form-values"])):(0,l.Q3)("",!0),e.isShowConfirmDialog?((0,l.uX)(),(0,l.Wv)(D.A,{key:1,"is-show-dialog":e.isShowConfirmDialog,title:e.confirmDialogInfo.title,content:e.confirmDialogInfo.content,"confirm-txt":e.confirmDialogInfo.confirmTxt,"cancel-txt":e.confirmDialogInfo.cancelTxt,onOnCancel:e.confirmDialogInfo.onCancel,onOnConfirm:e.confirmDialogInfo.onConfirm},null,8,["is-show-dialog","title","content","confirm-txt","cancel-txt","onOnCancel","onOnConfirm"])):(0,l.Q3)("",!0)])),_:1})}}};var K=i(7716),U=i(7837);const j=W,M=j;h()(W,"components",{QPage:K.A,QInput:U.A})}}]);